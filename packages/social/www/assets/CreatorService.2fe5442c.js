import{A as c}from"./AlertService.bfed2141.js";import{c as s}from"./feathers.081246a7.js";import{u}from"./upload.38e3baaf.js";import{q as l}from"./_app.009e96ac.js";const o={setStateCreators:r=>({type:"SET_STATE_CREATORS",splashTimeout:r}),creatorLoggedRetrieved:r=>({type:"CURRENT_CREATOR_RETRIEVED",creator:r}),creatorRetrieved:r=>({type:"CREATOR_RETRIEVED",creator:r}),fetchingCreators:()=>({type:"CREATORS_FETCH"}),fetchingCurrentCreator:()=>({type:"CURRENT_CREATOR_FETCH"}),fetchingCreator:()=>({type:"CREATOR_FETCH"}),creatorsRetrieved:r=>({type:"CREATORS_RETRIEVED",creators:r}),creatorNotificationList:r=>({type:"CREATOR_NOTIFICATION_LIST_RETRIEVED",notifications:r}),updateCreatorAsFollowed:()=>({type:"SET_CREATOR_AS_FOLLOWED"}),updateCreatorNotFollowed:()=>({type:"SET_CREATOR_NOT_FOLLOWED"}),updateCreatorAsBlocked:r=>({type:"SET_CREATOR_AS_BLOCKED",creatorId:r}),updateCreatorAsUnBlocked:r=>({type:"SET_CREATOR_AS_UN_BLOCKED",blokedCreatorId:r}),creatorBlockedUsers:r=>({type:"CREATOR_BLOCKED_RETRIEVED",creators:r}),creatorFollowers:r=>({type:"CREATOR_FOLLOWERS_RETRIEVED",creators:r}),creatorFollowing:r=>({type:"CREATOR_FOLLOWING_RETRIEVED",creators:r})},i={createCreator:r=>async(e,t)=>{try{e(o.fetchingCurrentCreator());let a=Math.floor(Math.random()*1e3)+1,n=r??{name:r?.name||"User"+a,username:r?.username||"user_"+a};const E=await s.service("creator").create(n);e(o.creatorLoggedRetrieved(E))}catch(a){console.log(a),c.dispatchAlertError(e,a.message)}},getLoggedCreator:()=>async r=>{try{r(o.fetchingCurrentCreator());const e=await s.service("creator").find({query:{action:"current"}});r(o.creatorLoggedRetrieved(e))}catch(e){console.log(e),c.dispatchAlertError(r,e.message)}},getCreators:r=>async(e,t)=>{try{e(o.fetchingCreators());const a=await s.service("creator").find({query:{}});e(o.creatorsRetrieved(a))}catch(a){console.log(a),c.dispatchAlertError(e,a.message)}},getCreator:r=>async e=>{try{e(o.fetchingCreator());const t=await s.service("creator").get(r);e(o.creatorRetrieved(t))}catch(t){console.log(t),c.dispatchAlertError(e,t.message)}},updateCreator:(r,e)=>async t=>{try{if(t(o.fetchingCurrentCreator()),r.newAvatar){const n=await u(r.newAvatar,null);r.avatarId=n.file_id,delete r.newAvatar}const a=await s.service("creator").patch(r.id,r);a&&(t(o.creatorLoggedRetrieved(a)),e&&e("succes"))}catch(a){console.log(a),c.dispatchAlertError(t,a.message),e&&e(a.message)}},getCreatorNotificationList:()=>async r=>{try{r(o.fetchingCreator());const e=await s.service("notifications").find({query:{action:"byCurrentCreator"}});r(o.creatorNotificationList(e))}catch(e){console.log(e),c.dispatchAlertError(r,e.message)}},followCreator:r=>async e=>{try{await s.service("follow-creator").create({creatorId:r})&&e(o.updateCreatorAsFollowed())}catch(t){console.log(t),c.dispatchAlertError(e,t.message)}},unFollowCreator:r=>async e=>{try{await s.service("follow-creator").remove(r)&&e(o.updateCreatorNotFollowed())}catch(t){console.log(t),c.dispatchAlertError(e,t.message)}},blockCreator:r=>async e=>{try{await s.service("block-creator").create({creatorId:r})&&e(o.updateCreatorAsBlocked(r))}catch(t){console.log(t),c.dispatchAlertError(e,t.message)}},unBlockCreator:r=>async e=>{try{const t=await s.service("block-creator").remove({blokedCreatorId:r});t&&(l(i.getBlockedList,e)(t),l(i.getCreators,e)())}catch(t){console.log(t),c.dispatchAlertError(e,t.message)}},getBlockedList:r=>async e=>{try{const t=await s.service("block-creator").find({query:{action:"blocked",creatorId:r}});e(o.creatorBlockedUsers(t.data))}catch(t){console.log(t),c.dispatchAlertError(e,t.message)}},getFollowersList:r=>async e=>{try{const t=await s.service("follow-creator").find({query:{action:"followers",creatorId:r}});e(o.creatorFollowers(t.data))}catch(t){console.log(t),c.dispatchAlertError(e,t.message)}},getFollowingList:r=>async e=>{try{const t=await s.service("follow-creator").find({query:{action:"following",creatorId:r}});e(o.creatorFollowing(t.data))}catch(t){console.log(t),c.dispatchAlertError(e,t.message)}}};export{i as C,o as a};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ3JlYXRvclNlcnZpY2UuMmZlNTQ0MmMuanMiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9yZWR1Y2Vycy9jcmVhdG9yL0NyZWF0b3JBY3Rpb25zLnRzIiwiLi4vLi4vc3JjL3JlZHVjZXJzL2NyZWF0b3IvQ3JlYXRvclNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAYXV0aG9yIFRhbnlhIFZ5a2xpdWsgPHRhbnlhLnZ5a2xpdWtAZ21haWwuY29tPlxuICovXG5cbmltcG9ydCB7IENyZWF0b3IsIENyZWF0b3JTaG9ydCB9IGZyb20gJ0B4cmVuZ2luZS9jb21tb24vc3JjL2ludGVyZmFjZXMvQ3JlYXRvcidcblxuZXhwb3J0IGNvbnN0IENyZWF0b3JBY3Rpb24gPSB7XG4gIHNldFN0YXRlQ3JlYXRvcnM6IChzcGxhc2hUaW1lb3V0OiBib29sZWFuKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdTRVRfU1RBVEVfQ1JFQVRPUlMnIGFzIGNvbnN0LFxuICAgICAgc3BsYXNoVGltZW91dFxuICAgIH1cbiAgfSxcbiAgY3JlYXRvckxvZ2dlZFJldHJpZXZlZDogKGNyZWF0b3I6IENyZWF0b3IpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ0NVUlJFTlRfQ1JFQVRPUl9SRVRSSUVWRUQnIGFzIGNvbnN0LFxuICAgICAgY3JlYXRvclxuICAgIH1cbiAgfSxcbiAgY3JlYXRvclJldHJpZXZlZDogKGNyZWF0b3I6IENyZWF0b3IpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ0NSRUFUT1JfUkVUUklFVkVEJyBhcyBjb25zdCxcbiAgICAgIGNyZWF0b3JcbiAgICB9XG4gIH0sXG4gIGZldGNoaW5nQ3JlYXRvcnM6ICgpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ0NSRUFUT1JTX0ZFVENIJyBhcyBjb25zdFxuICAgIH1cbiAgfSxcbiAgZmV0Y2hpbmdDdXJyZW50Q3JlYXRvcjogKCkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnQ1VSUkVOVF9DUkVBVE9SX0ZFVENIJyBhcyBjb25zdFxuICAgIH1cbiAgfSxcbiAgZmV0Y2hpbmdDcmVhdG9yOiAoKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdDUkVBVE9SX0ZFVENIJyBhcyBjb25zdFxuICAgIH1cbiAgfSxcbiAgY3JlYXRvcnNSZXRyaWV2ZWQ6IChjcmVhdG9yczogQ3JlYXRvclNob3J0W10pID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ0NSRUFUT1JTX1JFVFJJRVZFRCcgYXMgY29uc3QsXG4gICAgICBjcmVhdG9yc1xuICAgIH1cbiAgfSxcbiAgY3JlYXRvck5vdGlmaWNhdGlvbkxpc3Q6IChub3RpZmljYXRpb25zOiBhbnlbXSkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnQ1JFQVRPUl9OT1RJRklDQVRJT05fTElTVF9SRVRSSUVWRUQnIGFzIGNvbnN0LFxuICAgICAgbm90aWZpY2F0aW9uc1xuICAgIH1cbiAgfSxcbiAgdXBkYXRlQ3JlYXRvckFzRm9sbG93ZWQ6ICgpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ1NFVF9DUkVBVE9SX0FTX0ZPTExPV0VEJyBhcyBjb25zdFxuICAgIH1cbiAgfSxcbiAgdXBkYXRlQ3JlYXRvck5vdEZvbGxvd2VkOiAoKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdTRVRfQ1JFQVRPUl9OT1RfRk9MTE9XRUQnIGFzIGNvbnN0XG4gICAgfVxuICB9LFxuICB1cGRhdGVDcmVhdG9yQXNCbG9ja2VkOiAoY3JlYXRvcklkOiBzdHJpbmcpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ1NFVF9DUkVBVE9SX0FTX0JMT0NLRUQnIGFzIGNvbnN0LFxuICAgICAgY3JlYXRvcklkXG4gICAgfVxuICB9LFxuICB1cGRhdGVDcmVhdG9yQXNVbkJsb2NrZWQ6IChibG9rZWRDcmVhdG9ySWQ6IHN0cmluZykgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnU0VUX0NSRUFUT1JfQVNfVU5fQkxPQ0tFRCcgYXMgY29uc3QsXG4gICAgICBibG9rZWRDcmVhdG9ySWRcbiAgICB9XG4gIH0sXG4gIGNyZWF0b3JCbG9ja2VkVXNlcnM6IChjcmVhdG9yczogQ3JlYXRvclNob3J0W10pID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ0NSRUFUT1JfQkxPQ0tFRF9SRVRSSUVWRUQnIGFzIGNvbnN0LFxuICAgICAgY3JlYXRvcnNcbiAgICB9XG4gIH0sXG4gIGNyZWF0b3JGb2xsb3dlcnM6IChjcmVhdG9yczogQ3JlYXRvclNob3J0W10pID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ0NSRUFUT1JfRk9MTE9XRVJTX1JFVFJJRVZFRCcgYXMgY29uc3QsXG4gICAgICBjcmVhdG9yc1xuICAgIH1cbiAgfSxcbiAgY3JlYXRvckZvbGxvd2luZzogKGNyZWF0b3JzOiBDcmVhdG9yU2hvcnRbXSkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnQ1JFQVRPUl9GT0xMT1dJTkdfUkVUUklFVkVEJyBhcyBjb25zdCxcbiAgICAgIGNyZWF0b3JzXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCB0eXBlIENyZWF0b3JBY3Rpb25UeXBlID0gUmV0dXJuVHlwZTx0eXBlb2YgQ3JlYXRvckFjdGlvbltrZXlvZiB0eXBlb2YgQ3JlYXRvckFjdGlvbl0+XG4iLCIvKipcbiAqIEBhdXRob3IgVGFueWEgVnlrbGl1ayA8dGFueWEudnlrbGl1a0BnbWFpbC5jb20+XG4gKi9cbmltcG9ydCB7IEFsZXJ0U2VydmljZSB9IGZyb20gJ0B4cmVuZ2luZS9jbGllbnQtY29yZS9zcmMvY29tbW9uL3JlZHVjZXJzL2FsZXJ0L0FsZXJ0U2VydmljZSdcbmltcG9ydCB7IGNsaWVudCB9IGZyb20gJ0B4cmVuZ2luZS9jbGllbnQtY29yZS9zcmMvZmVhdGhlcnMnXG5pbXBvcnQgeyBDcmVhdG9yIH0gZnJvbSAnQHhyZW5naW5lL2NvbW1vbi9zcmMvaW50ZXJmYWNlcy9DcmVhdG9yJ1xuaW1wb3J0IHsgdXBsb2FkIH0gZnJvbSAnQHhyZW5naW5lL2VuZ2luZS9zcmMvc2NlbmUvZnVuY3Rpb25zL3VwbG9hZCdcbmltcG9ydCB7IERpc3BhdGNoLCBiaW5kQWN0aW9uQ3JlYXRvcnMgfSBmcm9tICdyZWR1eCdcblxuaW1wb3J0IHsgQ3JlYXRvckFjdGlvbiB9IGZyb20gJy4vQ3JlYXRvckFjdGlvbnMnXG5cbmV4cG9ydCBjb25zdCBDcmVhdG9yU2VydmljZSA9IHtcbiAgY3JlYXRlQ3JlYXRvcjogKGNyZWF0b3I/OiBDcmVhdG9yKSA9PiB7XG4gICAgcmV0dXJuIGFzeW5jIChkaXNwYXRjaDogRGlzcGF0Y2gsIGdldFN0YXRlOiBhbnkpOiBQcm9taXNlPGFueT4gPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgZGlzcGF0Y2goQ3JlYXRvckFjdGlvbi5mZXRjaGluZ0N1cnJlbnRDcmVhdG9yKCkpXG4gICAgICAgIGxldCB1c2VyTnVtYmVyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMCkgKyAxXG5cbiAgICAgICAgbGV0IGNyZWF0b3JJbmZvID1cbiAgICAgICAgICBjcmVhdG9yICE9IG51bGxcbiAgICAgICAgICAgID8gY3JlYXRvclxuICAgICAgICAgICAgOiB7XG4gICAgICAgICAgICAgICAgbmFtZTogY3JlYXRvcj8ubmFtZSB8fCAnVXNlcicgKyB1c2VyTnVtYmVyLFxuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiBjcmVhdG9yPy51c2VybmFtZSB8fCAndXNlcl8nICsgdXNlck51bWJlclxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY3JlYXRvclJlc3BvbnNlID0gYXdhaXQgY2xpZW50LnNlcnZpY2UoJ2NyZWF0b3InKS5jcmVhdGUoY3JlYXRvckluZm8pXG4gICAgICAgIGRpc3BhdGNoKENyZWF0b3JBY3Rpb24uY3JlYXRvckxvZ2dlZFJldHJpZXZlZChjcmVhdG9yUmVzcG9uc2UpKVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycilcbiAgICAgICAgQWxlcnRTZXJ2aWNlLmRpc3BhdGNoQWxlcnRFcnJvcihkaXNwYXRjaCwgZXJyLm1lc3NhZ2UpXG4gICAgICB9XG4gICAgfVxuICB9LFxuICBnZXRMb2dnZWRDcmVhdG9yOiAoKSA9PiB7XG4gICAgcmV0dXJuIGFzeW5jIChkaXNwYXRjaDogRGlzcGF0Y2gpOiBQcm9taXNlPGFueT4gPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgZGlzcGF0Y2goQ3JlYXRvckFjdGlvbi5mZXRjaGluZ0N1cnJlbnRDcmVhdG9yKCkpXG4gICAgICAgIGNvbnN0IGNyZWF0b3IgPSBhd2FpdCBjbGllbnQuc2VydmljZSgnY3JlYXRvcicpLmZpbmQoeyBxdWVyeTogeyBhY3Rpb246ICdjdXJyZW50JyB9IH0pXG4gICAgICAgIGRpc3BhdGNoKENyZWF0b3JBY3Rpb24uY3JlYXRvckxvZ2dlZFJldHJpZXZlZChjcmVhdG9yKSlcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICAgIEFsZXJ0U2VydmljZS5kaXNwYXRjaEFsZXJ0RXJyb3IoZGlzcGF0Y2gsIGVyci5tZXNzYWdlKVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgZ2V0Q3JlYXRvcnM6IChsaW1pdD86IG51bWJlcikgPT4ge1xuICAgIHJldHVybiBhc3luYyAoZGlzcGF0Y2g6IERpc3BhdGNoLCBnZXRTdGF0ZTogYW55KTogUHJvbWlzZTxhbnk+ID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGRpc3BhdGNoKENyZWF0b3JBY3Rpb24uZmV0Y2hpbmdDcmVhdG9ycygpKVxuICAgICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgY2xpZW50LnNlcnZpY2UoJ2NyZWF0b3InKS5maW5kKHsgcXVlcnk6IHt9IH0pXG4gICAgICAgIGRpc3BhdGNoKENyZWF0b3JBY3Rpb24uY3JlYXRvcnNSZXRyaWV2ZWQocmVzdWx0cykpXG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgICBBbGVydFNlcnZpY2UuZGlzcGF0Y2hBbGVydEVycm9yKGRpc3BhdGNoLCBlcnIubWVzc2FnZSlcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGdldENyZWF0b3I6IChjcmVhdG9ySWQpID0+IHtcbiAgICByZXR1cm4gYXN5bmMgKGRpc3BhdGNoOiBEaXNwYXRjaCk6IFByb21pc2U8YW55PiA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBkaXNwYXRjaChDcmVhdG9yQWN0aW9uLmZldGNoaW5nQ3JlYXRvcigpKVxuICAgICAgICBjb25zdCBjcmVhdG9yID0gYXdhaXQgY2xpZW50LnNlcnZpY2UoJ2NyZWF0b3InKS5nZXQoY3JlYXRvcklkKVxuICAgICAgICBkaXNwYXRjaChDcmVhdG9yQWN0aW9uLmNyZWF0b3JSZXRyaWV2ZWQoY3JlYXRvcikpXG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgICBBbGVydFNlcnZpY2UuZGlzcGF0Y2hBbGVydEVycm9yKGRpc3BhdGNoLCBlcnIubWVzc2FnZSlcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIHVwZGF0ZUNyZWF0b3I6IChjcmVhdG9yOiBDcmVhdG9yLCBjYWxsQmFjaz86IEZ1bmN0aW9uKSA9PiB7XG4gICAgcmV0dXJuIGFzeW5jIChkaXNwYXRjaDogRGlzcGF0Y2gpOiBQcm9taXNlPGFueT4gPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgZGlzcGF0Y2goQ3JlYXRvckFjdGlvbi5mZXRjaGluZ0N1cnJlbnRDcmVhdG9yKCkpXG4gICAgICAgIGlmIChjcmVhdG9yLm5ld0F2YXRhcikge1xuICAgICAgICAgIGNvbnN0IHN0b3JlZEF2YXRhciA9IGF3YWl0IHVwbG9hZChjcmVhdG9yLm5ld0F2YXRhciwgbnVsbClcbiAgICAgICAgICAvL0B0cy1pZ25vcmUgZXJyb3IgdGhhdCB0aGlzIHZhcnMgYXJlIHZvaWQgYmVjYXVzZSB1cGxvYWQgaXMgZGVmaW5lcyBhcyB2b2lkIGZ1bnRpb25cbiAgICAgICAgICBjcmVhdG9yLmF2YXRhcklkID0gc3RvcmVkQXZhdGFyLmZpbGVfaWRcbiAgICAgICAgICBkZWxldGUgY3JlYXRvci5uZXdBdmF0YXJcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB1cGRhdGVkQ3JlYXRvciA9IGF3YWl0IGNsaWVudC5zZXJ2aWNlKCdjcmVhdG9yJykucGF0Y2goY3JlYXRvci5pZCwgY3JlYXRvcilcbiAgICAgICAgaWYgKHVwZGF0ZWRDcmVhdG9yKSB7XG4gICAgICAgICAgZGlzcGF0Y2goQ3JlYXRvckFjdGlvbi5jcmVhdG9yTG9nZ2VkUmV0cmlldmVkKHVwZGF0ZWRDcmVhdG9yKSlcbiAgICAgICAgICBpZiAoY2FsbEJhY2spIHtcbiAgICAgICAgICAgIGNhbGxCYWNrKCdzdWNjZXMnKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycilcbiAgICAgICAgQWxlcnRTZXJ2aWNlLmRpc3BhdGNoQWxlcnRFcnJvcihkaXNwYXRjaCwgZXJyLm1lc3NhZ2UpXG4gICAgICAgIGlmIChjYWxsQmFjaykge1xuICAgICAgICAgIGNhbGxCYWNrKGVyci5tZXNzYWdlKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLU5PVCB1c2VkIGZvciBub3dcbiAgZ2V0Q3JlYXRvck5vdGlmaWNhdGlvbkxpc3Q6ICgpID0+IHtcbiAgICByZXR1cm4gYXN5bmMgKGRpc3BhdGNoOiBEaXNwYXRjaCk6IFByb21pc2U8YW55PiA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBkaXNwYXRjaChDcmVhdG9yQWN0aW9uLmZldGNoaW5nQ3JlYXRvcigpKVxuICAgICAgICBjb25zdCBub3RpZmljYXRpb25MaXN0ID0gYXdhaXQgY2xpZW50LnNlcnZpY2UoJ25vdGlmaWNhdGlvbnMnKS5maW5kKHsgcXVlcnk6IHsgYWN0aW9uOiAnYnlDdXJyZW50Q3JlYXRvcicgfSB9KVxuICAgICAgICBkaXNwYXRjaChDcmVhdG9yQWN0aW9uLmNyZWF0b3JOb3RpZmljYXRpb25MaXN0KG5vdGlmaWNhdGlvbkxpc3QpKVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycilcbiAgICAgICAgQWxlcnRTZXJ2aWNlLmRpc3BhdGNoQWxlcnRFcnJvcihkaXNwYXRjaCwgZXJyLm1lc3NhZ2UpXG4gICAgICB9XG4gICAgfVxuICB9LFxuICBmb2xsb3dDcmVhdG9yOiAoY3JlYXRvcklkOiBzdHJpbmcpID0+IHtcbiAgICByZXR1cm4gYXN5bmMgKGRpc3BhdGNoOiBEaXNwYXRjaCk6IFByb21pc2U8YW55PiA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBmb2xsb3cgPSBhd2FpdCBjbGllbnQuc2VydmljZSgnZm9sbG93LWNyZWF0b3InKS5jcmVhdGUoeyBjcmVhdG9ySWQgfSlcbiAgICAgICAgZm9sbG93ICYmIGRpc3BhdGNoKENyZWF0b3JBY3Rpb24udXBkYXRlQ3JlYXRvckFzRm9sbG93ZWQoKSlcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICAgIEFsZXJ0U2VydmljZS5kaXNwYXRjaEFsZXJ0RXJyb3IoZGlzcGF0Y2gsIGVyci5tZXNzYWdlKVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgdW5Gb2xsb3dDcmVhdG9yOiAoY3JlYXRvcklkOiBzdHJpbmcpID0+IHtcbiAgICByZXR1cm4gYXN5bmMgKGRpc3BhdGNoOiBEaXNwYXRjaCk6IFByb21pc2U8YW55PiA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBmb2xsb3cgPSBhd2FpdCBjbGllbnQuc2VydmljZSgnZm9sbG93LWNyZWF0b3InKS5yZW1vdmUoY3JlYXRvcklkKVxuICAgICAgICBmb2xsb3cgJiYgZGlzcGF0Y2goQ3JlYXRvckFjdGlvbi51cGRhdGVDcmVhdG9yTm90Rm9sbG93ZWQoKSlcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICAgIEFsZXJ0U2VydmljZS5kaXNwYXRjaEFsZXJ0RXJyb3IoZGlzcGF0Y2gsIGVyci5tZXNzYWdlKVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYmxvY2tDcmVhdG9yOiAoY3JlYXRvcklkOiBzdHJpbmcpID0+IHtcbiAgICByZXR1cm4gYXN5bmMgKGRpc3BhdGNoOiBEaXNwYXRjaCk6IFByb21pc2U8YW55PiA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBmb2xsb3cgPSBhd2FpdCBjbGllbnQuc2VydmljZSgnYmxvY2stY3JlYXRvcicpLmNyZWF0ZSh7IGNyZWF0b3JJZCB9KVxuICAgICAgICBmb2xsb3cgJiYgZGlzcGF0Y2goQ3JlYXRvckFjdGlvbi51cGRhdGVDcmVhdG9yQXNCbG9ja2VkKGNyZWF0b3JJZCkpXG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgICBBbGVydFNlcnZpY2UuZGlzcGF0Y2hBbGVydEVycm9yKGRpc3BhdGNoLCBlcnIubWVzc2FnZSlcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIHVuQmxvY2tDcmVhdG9yOiAoYmxva2VkQ3JlYXRvcklkOiBzdHJpbmcpID0+IHtcbiAgICByZXR1cm4gYXN5bmMgKGRpc3BhdGNoOiBEaXNwYXRjaCk6IFByb21pc2U8YW55PiA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBmb2xsb3cgPSBhd2FpdCBjbGllbnQuc2VydmljZSgnYmxvY2stY3JlYXRvcicpLnJlbW92ZSh7IGJsb2tlZENyZWF0b3JJZCB9KVxuICAgICAgICBpZiAoZm9sbG93KSB7XG4gICAgICAgICAgYmluZEFjdGlvbkNyZWF0b3JzKENyZWF0b3JTZXJ2aWNlLmdldEJsb2NrZWRMaXN0LCBkaXNwYXRjaCkoZm9sbG93KVxuICAgICAgICAgIGJpbmRBY3Rpb25DcmVhdG9ycyhDcmVhdG9yU2VydmljZS5nZXRDcmVhdG9ycywgZGlzcGF0Y2gpKClcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycilcbiAgICAgICAgQWxlcnRTZXJ2aWNlLmRpc3BhdGNoQWxlcnRFcnJvcihkaXNwYXRjaCwgZXJyLm1lc3NhZ2UpXG4gICAgICB9XG4gICAgfVxuICB9LFxuICBnZXRCbG9ja2VkTGlzdDogKGNyZWF0b3JJZDogc3RyaW5nKSA9PiB7XG4gICAgcmV0dXJuIGFzeW5jIChkaXNwYXRjaDogRGlzcGF0Y2gpOiBQcm9taXNlPGFueT4gPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgbGlzdCA9IGF3YWl0IGNsaWVudC5zZXJ2aWNlKCdibG9jay1jcmVhdG9yJykuZmluZCh7IHF1ZXJ5OiB7IGFjdGlvbjogJ2Jsb2NrZWQnLCBjcmVhdG9ySWQgfSB9KVxuICAgICAgICBkaXNwYXRjaChDcmVhdG9yQWN0aW9uLmNyZWF0b3JCbG9ja2VkVXNlcnMobGlzdC5kYXRhKSlcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICAgIEFsZXJ0U2VydmljZS5kaXNwYXRjaEFsZXJ0RXJyb3IoZGlzcGF0Y2gsIGVyci5tZXNzYWdlKVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgZ2V0Rm9sbG93ZXJzTGlzdDogKGNyZWF0b3JJZDogc3RyaW5nKSA9PiB7XG4gICAgcmV0dXJuIGFzeW5jIChkaXNwYXRjaDogRGlzcGF0Y2gpOiBQcm9taXNlPGFueT4gPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgbGlzdCA9IGF3YWl0IGNsaWVudC5zZXJ2aWNlKCdmb2xsb3ctY3JlYXRvcicpLmZpbmQoeyBxdWVyeTogeyBhY3Rpb246ICdmb2xsb3dlcnMnLCBjcmVhdG9ySWQgfSB9KVxuICAgICAgICBkaXNwYXRjaChDcmVhdG9yQWN0aW9uLmNyZWF0b3JGb2xsb3dlcnMobGlzdC5kYXRhKSlcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICAgIEFsZXJ0U2VydmljZS5kaXNwYXRjaEFsZXJ0RXJyb3IoZGlzcGF0Y2gsIGVyci5tZXNzYWdlKVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgZ2V0Rm9sbG93aW5nTGlzdDogKGNyZWF0b3JJZDogc3RyaW5nKSA9PiB7XG4gICAgcmV0dXJuIGFzeW5jIChkaXNwYXRjaDogRGlzcGF0Y2gpOiBQcm9taXNlPGFueT4gPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgbGlzdCA9IGF3YWl0IGNsaWVudC5zZXJ2aWNlKCdmb2xsb3ctY3JlYXRvcicpLmZpbmQoeyBxdWVyeTogeyBhY3Rpb246ICdmb2xsb3dpbmcnLCBjcmVhdG9ySWQgfSB9KVxuICAgICAgICBkaXNwYXRjaChDcmVhdG9yQWN0aW9uLmNyZWF0b3JGb2xsb3dpbmcobGlzdC5kYXRhKSlcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICAgIEFsZXJ0U2VydmljZS5kaXNwYXRjaEFsZXJ0RXJyb3IoZGlzcGF0Y2gsIGVyci5tZXNzYWdlKVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIwS0FNYSxHQUFnQixDQUMzQixpQkFBa0IsQUFBQyxHQUNWLEVBQ0wsS0FBTSxxQkFDTixrQkFHSix1QkFBd0IsQUFBQyxHQUNoQixFQUNMLEtBQU0sNEJBQ04sWUFHSixpQkFBa0IsQUFBQyxHQUNWLEVBQ0wsS0FBTSxvQkFDTixZQUdKLGlCQUFrQixJQUNULEVBQ0wsS0FBTSxtQkFHVix1QkFBd0IsSUFDZixFQUNMLEtBQU0sMEJBR1YsZ0JBQWlCLElBQ1IsRUFDTCxLQUFNLGtCQUdWLGtCQUFtQixBQUFDLEdBQ1gsRUFDTCxLQUFNLHFCQUNOLGFBR0osd0JBQXlCLEFBQUMsR0FDakIsRUFDTCxLQUFNLHNDQUNOLGtCQUdKLHdCQUF5QixJQUNoQixFQUNMLEtBQU0sNEJBR1YseUJBQTBCLElBQ2pCLEVBQ0wsS0FBTSw2QkFHVix1QkFBd0IsQUFBQyxHQUNoQixFQUNMLEtBQU0seUJBQ04sY0FHSix5QkFBMEIsQUFBQyxHQUNsQixFQUNMLEtBQU0sNEJBQ04sb0JBR0osb0JBQXFCLEFBQUMsR0FDYixFQUNMLEtBQU0sNEJBQ04sYUFHSixpQkFBa0IsQUFBQyxHQUNWLEVBQ0wsS0FBTSw4QkFDTixhQUdKLGlCQUFrQixBQUFDLEdBQ1YsRUFDTCxLQUFNLDhCQUNOLGNDOUVPLEVBQWlCLENBQzVCLGNBQWUsQUFBQyxHQUNQLE1BQU8sRUFBb0IsSUFBZ0MsSUFDNUQsR0FDTyxFQUFjLDZCQUNuQixHQUFhLEtBQUssTUFBTSxLQUFLLFNBQVcsS0FBUSxFQUVoRCxFQUNGLEdBRUksQ0FDRSxLQUFNLEdBQVMsTUFBUSxPQUFTLEVBQ2hDLFNBQVUsR0FBUyxVQUFZLFFBQVUsUUFHM0MsR0FBa0IsS0FBTSxHQUFPLFFBQVEsV0FBVyxPQUFPLEtBQ3RELEVBQWMsdUJBQXVCLFVBQ3ZDLFdBQ0MsSUFBSSxLQUNDLG1CQUFtQixFQUFVLEVBQUksV0FJcEQsaUJBQWtCLElBQ1QsS0FBTyxJQUFxQyxJQUM3QyxHQUNPLEVBQWMsK0JBQ2pCLEdBQVUsS0FBTSxHQUFPLFFBQVEsV0FBVyxLQUFLLENBQUUsTUFBTyxDQUFFLE9BQVEsZUFDL0QsRUFBYyx1QkFBdUIsVUFDdkMsV0FDQyxJQUFJLEtBQ0MsbUJBQW1CLEVBQVUsRUFBSSxXQUlwRCxZQUFhLEFBQUMsR0FDTCxNQUFPLEVBQW9CLElBQWdDLElBQzVELEdBQ08sRUFBYyx5QkFDakIsR0FBVSxLQUFNLEdBQU8sUUFBUSxXQUFXLEtBQUssQ0FBRSxNQUFPLE9BQ3JELEVBQWMsa0JBQWtCLFVBQ2xDLFdBQ0MsSUFBSSxLQUNDLG1CQUFtQixFQUFVLEVBQUksV0FJcEQsV0FBWSxBQUFDLEdBQ0osS0FBTyxJQUFxQyxJQUM3QyxHQUNPLEVBQWMsd0JBQ2pCLEdBQVUsS0FBTSxHQUFPLFFBQVEsV0FBVyxJQUFJLEtBQzNDLEVBQWMsaUJBQWlCLFVBQ2pDLFdBQ0MsSUFBSSxLQUNDLG1CQUFtQixFQUFVLEVBQUksV0FJcEQsY0FBZSxDQUFDLEVBQWtCLElBQ3pCLEtBQU8sSUFBcUMsSUFDN0MsTUFDTyxFQUFjLDBCQUNuQixFQUFRLFVBQVcsTUFDZixHQUFlLEtBQU0sR0FBTyxFQUFRLFVBQVcsUUFFN0MsU0FBVyxFQUFhLGNBQ3pCLEdBQVEsZUFFWCxHQUFpQixLQUFNLEdBQU8sUUFBUSxXQUFXLE1BQU0sRUFBUSxHQUFJLEdBQ3JFLE1BQ08sRUFBYyx1QkFBdUIsSUFDMUMsS0FDTyxpQkFHTixXQUNDLElBQUksS0FDQyxtQkFBbUIsRUFBVSxFQUFJLFNBQzFDLEtBQ08sRUFBSSxXQU1yQiwyQkFBNEIsSUFDbkIsS0FBTyxJQUFxQyxJQUM3QyxHQUNPLEVBQWMsd0JBQ2pCLEdBQW1CLEtBQU0sR0FBTyxRQUFRLGlCQUFpQixLQUFLLENBQUUsTUFBTyxDQUFFLE9BQVEsd0JBQzlFLEVBQWMsd0JBQXdCLFVBQ3hDLFdBQ0MsSUFBSSxLQUNDLG1CQUFtQixFQUFVLEVBQUksV0FJcEQsY0FBZSxBQUFDLEdBQ1AsS0FBTyxJQUFxQyxJQUM3QyxDQUNhLEtBQU0sR0FBTyxRQUFRLGtCQUFrQixPQUFPLENBQUUsZUFDckQsRUFBUyxFQUFjLGlDQUMxQixXQUNDLElBQUksS0FDQyxtQkFBbUIsRUFBVSxFQUFJLFdBSXBELGdCQUFpQixBQUFDLEdBQ1QsS0FBTyxJQUFxQyxJQUM3QyxDQUNhLEtBQU0sR0FBTyxRQUFRLGtCQUFrQixPQUFPLElBQ25ELEVBQVMsRUFBYyxrQ0FDMUIsV0FDQyxJQUFJLEtBQ0MsbUJBQW1CLEVBQVUsRUFBSSxXQUlwRCxhQUFjLEFBQUMsR0FDTixLQUFPLElBQXFDLElBQzdDLENBQ2EsS0FBTSxHQUFPLFFBQVEsaUJBQWlCLE9BQU8sQ0FBRSxlQUNwRCxFQUFTLEVBQWMsdUJBQXVCLFVBQ2pELFdBQ0MsSUFBSSxLQUNDLG1CQUFtQixFQUFVLEVBQUksV0FJcEQsZUFBZ0IsQUFBQyxHQUNSLEtBQU8sSUFBcUMsSUFDN0MsTUFDSSxHQUFTLEtBQU0sR0FBTyxRQUFRLGlCQUFpQixPQUFPLENBQUUsb0JBQzFELE1BQ2lCLEVBQWUsZUFBZ0IsR0FBVSxLQUN6QyxFQUFlLFlBQWEsWUFFMUMsV0FDQyxJQUFJLEtBQ0MsbUJBQW1CLEVBQVUsRUFBSSxXQUlwRCxlQUFnQixBQUFDLEdBQ1IsS0FBTyxJQUFxQyxJQUM3QyxNQUNJLEdBQU8sS0FBTSxHQUFPLFFBQVEsaUJBQWlCLEtBQUssQ0FBRSxNQUFPLENBQUUsT0FBUSxVQUFXLGlCQUM3RSxFQUFjLG9CQUFvQixFQUFLLGFBQ3pDLFdBQ0MsSUFBSSxLQUNDLG1CQUFtQixFQUFVLEVBQUksV0FJcEQsaUJBQWtCLEFBQUMsR0FDVixLQUFPLElBQXFDLElBQzdDLE1BQ0ksR0FBTyxLQUFNLEdBQU8sUUFBUSxrQkFBa0IsS0FBSyxDQUFFLE1BQU8sQ0FBRSxPQUFRLFlBQWEsaUJBQ2hGLEVBQWMsaUJBQWlCLEVBQUssYUFDdEMsV0FDQyxJQUFJLEtBQ0MsbUJBQW1CLEVBQVUsRUFBSSxXQUlwRCxpQkFBa0IsQUFBQyxHQUNWLEtBQU8sSUFBcUMsSUFDN0MsTUFDSSxHQUFPLEtBQU0sR0FBTyxRQUFRLGtCQUFrQixLQUFLLENBQUUsTUFBTyxDQUFFLE9BQVEsWUFBYSxpQkFDaEYsRUFBYyxpQkFBaUIsRUFBSyxhQUN0QyxXQUNDLElBQUksS0FDQyxtQkFBbUIsRUFBVSxFQUFJIn0=

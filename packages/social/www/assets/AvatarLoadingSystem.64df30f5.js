import{O as I,ak as Q}from"./three.module.493739a3.js";import{T as D,E as F}from"./tween.esm.78508545.js";import{c as L,t as O,d as C,B as h,D as _,A as B,g as l,a as x,r as v,F as k}from"./avatarFunctions.6d66cf01.js";import{O as p}from"./[projectId].a008d20c.js";import{T as y}from"./TweenComponent.b7ca1b88.js";import"./index.7b02be28.js";import"./vendor.475cb2ff.js";import"./_app.f0a72417.js";import"./AuthService.e8999ddc.js";import"./AlertService.5d8abaff.js";import"./feathers.32f4d4e8.js";import"./SystemUpdateType.772fc25d.js";import"./upload.bd537b46.js";import"./index.81138b53.js";const g=L("AvatarDissolveComponent"),z=(r,f)=>Math.min(1,Math.max(.001,r/f)),R=(r,f)=>Math.min(1,Math.max(0,1-(r-f)*.5));async function et(r){await O.loadAsync({url:"/itemLight.png"}),await O.loadAsync({url:"/itemPlate.png"});const f=C([h,p,_]),E=C([h,p]),T=C([B,p,g]);return()=>{const{delta:A}=r;for(const t of f.enter(r)){const b=l(t,p).value,d=l(t,h),a=new I;a.name="pillar_obj",b.add(a);const i=l(t,_),n=i.light,e=i.plate,c=.6*e.geometry.boundingSphere?.radius;for(let u=0,j=5+10*c*Math.random();u<j;u+=1){const m=n.clone();m.material=n.material.clone(),m.position.y-=2*m.geometry.boundingSphere?.radius*Math.random();var w=2*Math.PI*u/j,S=c*Math.random();m.position.x+=S*Math.cos(w),m.position.z+=S*Math.sin(w),m.rotation.y=Math.random()*2*Math.PI,a.add(m)}const o=e.clone();o.name="plate_obj",o.material=o.material.clone(),b.add(o),o.rotation.x=-.5*Math.PI,x(t,y,{tween:new D(d).to({opacityMultiplier:1},1e3).easing(F.Exponential.Out).start().onComplete(()=>{v(t,y);const u=l(t,p).value,j=new Q().setFromObject(u.children[0]);x(t,g,{effect:new k(u,j.min.y,j.max.y)})})})}for(const t of f.exit(r));for(const t of E(r)){const b=l(t,p).value,d=l(t,h).opacityMultiplier;let a=null,i=null;const n=b.children;for(let e=0;e<n.length;e++)n[e].name==="pillar_obj"&&(a=n[e]),n[e].name==="plate_obj"&&(i=n[e]);if(a!==null&&i!==null&&(i.material.opacity=d*(.7+.5*Math.sin(Date.now()%6283*.005)),a!==void 0&&i!==void 0))for(var M=0,P=a.children.length;M<P;M++){var s=a.children[M];s.position.y+=2*A,s.scale.y=z(s.position.y,s.geometry.boundingSphere.radius),s.material.opacity=R(s.position.y,s.geometry.boundingSphere.radius),s.material.opacity<.001&&(s.position.y=i.position.y),s.material.opacity*=d}}for(const t of T(r))if(l(t,g).effect.update(A)){v(t,g);const d=l(t,p).value,a=l(t,h);a.originMaterials.forEach(({id:i,material:n})=>{d.traverse(e=>{e.uuid===i&&(e.material=n)})}),x(t,y,{tween:new D(a).to({opacityMultiplier:0},2e3).start().onComplete(async()=>{v(t,y);const i=l(t,p).value;let n=null,e=null;const c=i.children;for(let o=0;o<c.length;o++)c[o].name==="pillar_obj"&&(n=c[o]),c[o].name==="plate_obj"&&(e=c[o]);n!==null&&(n.traverse(function(o){o.material&&o.material.dispose()}),n.parent.remove(n)),e!==null&&(e.traverse(function(o){o.material&&o.material.dispose()}),e.parent.remove(e)),v(t,h)})})}return r}}export{et as default};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXZhdGFyTG9hZGluZ1N5c3RlbS42NGRmMzBmNS5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vZW5naW5lL3NyYy9hdmF0YXIvY29tcG9uZW50cy9BdmF0YXJEaXNzb2x2ZUNvbXBvbmVudC50cyIsIi4uLy4uLy4uL2VuZ2luZS9zcmMvYXZhdGFyL0F2YXRhckxvYWRpbmdTeXN0ZW0udHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlTWFwcGVkQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vZWNzL2Z1bmN0aW9ucy9Db21wb25lbnRGdW5jdGlvbnMnXG5pbXBvcnQgeyBEaXNzb2x2ZUVmZmVjdCB9IGZyb20gJy4uL0Rpc3NvbHZlRWZmZWN0J1xuXG5leHBvcnQgdHlwZSBBdmF0YXJEaXNzb2x2ZUNvbXBvbmVudFR5cGUgPSB7XG4gIGVmZmVjdDogRGlzc29sdmVFZmZlY3Rcbn1cblxuZXhwb3J0IGNvbnN0IEF2YXRhckRpc3NvbHZlQ29tcG9uZW50ID0gY3JlYXRlTWFwcGVkQ29tcG9uZW50PEF2YXRhckRpc3NvbHZlQ29tcG9uZW50VHlwZT4oJ0F2YXRhckRpc3NvbHZlQ29tcG9uZW50JylcbiIsImltcG9ydCB7IE9iamVjdDNELCBzUkdCRW5jb2RpbmcsIEJveDMsIFZlY3RvcjMgfSBmcm9tICd0aHJlZSdcbmltcG9ydCB7IEVhc2luZywgVHdlZW4gfSBmcm9tICdAdHdlZW5qcy90d2Vlbi5qcydcblxuaW1wb3J0IHtcbiAgZ2V0Q29tcG9uZW50LFxuICBoYXNDb21wb25lbnQsXG4gIGFkZENvbXBvbmVudCxcbiAgcmVtb3ZlQ29tcG9uZW50LFxuICBkZWZpbmVRdWVyeVxufSBmcm9tICcuLi9lY3MvZnVuY3Rpb25zL0NvbXBvbmVudEZ1bmN0aW9ucydcblxuaW1wb3J0IHsgQXNzZXRMb2FkZXIgfSBmcm9tICcuLi9hc3NldHMvY2xhc3Nlcy9Bc3NldExvYWRlcidcblxuaW1wb3J0IHsgT2JqZWN0M0RDb21wb25lbnQgfSBmcm9tICcuLi9zY2VuZS9jb21wb25lbnRzL09iamVjdDNEQ29tcG9uZW50J1xuaW1wb3J0IHsgQXZhdGFyUGVuZGluZ0NvbXBvbmVudCB9IGZyb20gJy4vY29tcG9uZW50cy9BdmF0YXJQZW5kaW5nQ29tcG9uZW50J1xuaW1wb3J0IHsgQXZhdGFyQ29tcG9uZW50IH0gZnJvbSAnLi9jb21wb25lbnRzL0F2YXRhckNvbXBvbmVudCdcbmltcG9ydCB7IEF2YXRhckRpc3NvbHZlQ29tcG9uZW50IH0gZnJvbSAnLi9jb21wb25lbnRzL0F2YXRhckRpc3NvbHZlQ29tcG9uZW50J1xuaW1wb3J0IHsgQXZhdGFyRWZmZWN0Q29tcG9uZW50IH0gZnJvbSAnLi9jb21wb25lbnRzL0F2YXRhckVmZmVjdENvbXBvbmVudCdcbmltcG9ydCB7IFR3ZWVuQ29tcG9uZW50IH0gZnJvbSAnLi4vdHJhbnNmb3JtL2NvbXBvbmVudHMvVHdlZW5Db21wb25lbnQnXG5pbXBvcnQgeyBEaXNzb2x2ZUVmZmVjdCB9IGZyb20gJy4vRGlzc29sdmVFZmZlY3QnXG5pbXBvcnQgeyBMb2NhbElucHV0VGFnQ29tcG9uZW50IH0gZnJvbSAnLi4vaW5wdXQvY29tcG9uZW50cy9Mb2NhbElucHV0VGFnQ29tcG9uZW50J1xuaW1wb3J0IHsgaXNFbnRpdHlMb2NhbENsaWVudCB9IGZyb20gJy4uL25ldHdvcmtpbmcvZnVuY3Rpb25zL2lzRW50aXR5TG9jYWxDbGllbnQnXG5pbXBvcnQgeyBTeXN0ZW0gfSBmcm9tICcuLi9lY3MvY2xhc3Nlcy9TeXN0ZW0nXG5pbXBvcnQgeyBXb3JsZCB9IGZyb20gJy4uL2Vjcy9jbGFzc2VzL1dvcmxkJ1xuXG5jb25zdCBsaWdodFNjYWxlID0gKHksIHIpID0+IHtcbiAgcmV0dXJuIE1hdGgubWluKDEsIE1hdGgubWF4KDFlLTMsIHkgLyByKSlcbn1cblxuY29uc3QgbGlnaHRPcGFjaXR5ID0gKHksIHIpID0+IHtcbiAgcmV0dXJuIE1hdGgubWluKDEsIE1hdGgubWF4KDAsIDEgLSAoeSAtIHIpICogMC41KSlcbn1cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gQXZhdGFyTG9hZGluZ1N5c3RlbSh3b3JsZDogV29ybGQpOiBQcm9taXNlPFN5c3RlbT4ge1xuICAvLyBwcmVjYWNoZSBkaXNzb2x2ZSBlZmZlY3RzXG4gIGF3YWl0IEFzc2V0TG9hZGVyLmxvYWRBc3luYyh7IHVybDogJy9pdGVtTGlnaHQucG5nJyB9KVxuICBhd2FpdCBBc3NldExvYWRlci5sb2FkQXN5bmMoeyB1cmw6ICcvaXRlbVBsYXRlLnBuZycgfSlcblxuICBjb25zdCBncm93UXVlcnkgPSBkZWZpbmVRdWVyeShbQXZhdGFyRWZmZWN0Q29tcG9uZW50LCBPYmplY3QzRENvbXBvbmVudCwgQXZhdGFyUGVuZGluZ0NvbXBvbmVudF0pXG4gIGNvbnN0IGNvbW1vblF1ZXJ5ID0gZGVmaW5lUXVlcnkoW0F2YXRhckVmZmVjdENvbXBvbmVudCwgT2JqZWN0M0RDb21wb25lbnRdKVxuICBjb25zdCBkaXNzb2x2ZVF1ZXJ5ID0gZGVmaW5lUXVlcnkoW0F2YXRhckNvbXBvbmVudCwgT2JqZWN0M0RDb21wb25lbnQsIEF2YXRhckRpc3NvbHZlQ29tcG9uZW50XSlcblxuICByZXR1cm4gKCkgPT4ge1xuICAgIGNvbnN0IHsgZGVsdGEgfSA9IHdvcmxkXG5cbiAgICBmb3IgKGNvbnN0IGVudGl0eSBvZiBncm93UXVlcnkuZW50ZXIod29ybGQpKSB7XG4gICAgICBjb25zdCBvYmplY3QgPSBnZXRDb21wb25lbnQoZW50aXR5LCBPYmplY3QzRENvbXBvbmVudCkudmFsdWVcbiAgICAgIGNvbnN0IHBsYXRlQ29tcG9uZW50ID0gZ2V0Q29tcG9uZW50KGVudGl0eSwgQXZhdGFyRWZmZWN0Q29tcG9uZW50KVxuXG4gICAgICBjb25zdCBwaWxsYXIgPSBuZXcgT2JqZWN0M0QoKVxuICAgICAgcGlsbGFyLm5hbWUgPSAncGlsbGFyX29iaidcbiAgICAgIG9iamVjdC5hZGQocGlsbGFyKVxuXG4gICAgICBjb25zdCBhcGMgPSBnZXRDb21wb25lbnQoZW50aXR5LCBBdmF0YXJQZW5kaW5nQ29tcG9uZW50KVxuICAgICAgY29uc3QgbGlnaHQgPSBhcGMubGlnaHRcbiAgICAgIGNvbnN0IHBsYXRlID0gYXBjLnBsYXRlXG5cbiAgICAgIGNvbnN0IFIgPSAwLjYgKiBwbGF0ZS5nZW9tZXRyeS5ib3VuZGluZ1NwaGVyZT8ucmFkaXVzIVxuICAgICAgZm9yIChsZXQgaSA9IDAsIG4gPSA1ICsgMTAgKiBSICogTWF0aC5yYW5kb20oKTsgaSA8IG47IGkgKz0gMSkge1xuICAgICAgICBjb25zdCByYXkgPSBsaWdodC5jbG9uZSgpXG4gICAgICAgIHJheS5tYXRlcmlhbCA9ICg8YW55PmxpZ2h0Lm1hdGVyaWFsKS5jbG9uZSgpXG4gICAgICAgIHJheS5wb3NpdGlvbi55IC09IDIgKiByYXkuZ2VvbWV0cnkuYm91bmRpbmdTcGhlcmU/LnJhZGl1cyEgKiBNYXRoLnJhbmRvbSgpXG5cbiAgICAgICAgdmFyIGEgPSAoMiAqIE1hdGguUEkgKiBpKSAvIG4sXG4gICAgICAgICAgciA9IFIgKiBNYXRoLnJhbmRvbSgpXG4gICAgICAgIHJheS5wb3NpdGlvbi54ICs9IHIgKiBNYXRoLmNvcyhhKVxuICAgICAgICByYXkucG9zaXRpb24ueiArPSByICogTWF0aC5zaW4oYSlcblxuICAgICAgICByYXkucm90YXRpb24ueSA9IE1hdGgucmFuZG9tKCkgKiAyICogTWF0aC5QSVxuICAgICAgICBwaWxsYXIuYWRkKHJheSlcbiAgICAgIH1cblxuICAgICAgY29uc3QgcHQgPSBwbGF0ZS5jbG9uZSgpXG4gICAgICBwdC5uYW1lID0gJ3BsYXRlX29iaidcbiAgICAgIHB0Lm1hdGVyaWFsID0gKDxhbnk+cHQubWF0ZXJpYWwpLmNsb25lKClcbiAgICAgIG9iamVjdC5hZGQocHQpXG4gICAgICBwdC5yb3RhdGlvbi54ID0gLTAuNSAqIE1hdGguUElcblxuICAgICAgLy8gaWYgKGlzRW50aXR5TG9jYWxDbGllbnQoZW50aXR5KSkge1xuICAgICAgLy8gICByZW1vdmVDb21wb25lbnQoZW50aXR5LCBMb2NhbElucHV0VGFnQ29tcG9uZW50KVxuICAgICAgLy8gfVxuXG4gICAgICBhZGRDb21wb25lbnQoZW50aXR5LCBUd2VlbkNvbXBvbmVudCwge1xuICAgICAgICB0d2VlbjogbmV3IFR3ZWVuPGFueT4ocGxhdGVDb21wb25lbnQpXG4gICAgICAgICAgLnRvKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBvcGFjaXR5TXVsdGlwbGllcjogMVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIDEwMDBcbiAgICAgICAgICApXG4gICAgICAgICAgLmVhc2luZyhFYXNpbmcuRXhwb25lbnRpYWwuT3V0KVxuICAgICAgICAgIC5zdGFydCgpXG4gICAgICAgICAgLm9uQ29tcGxldGUoKCkgPT4ge1xuICAgICAgICAgICAgcmVtb3ZlQ29tcG9uZW50KGVudGl0eSwgVHdlZW5Db21wb25lbnQpXG4gICAgICAgICAgICAvLyByZW1vdmVDb21wb25lbnQoZW50aXR5LCBBdmF0YXJQZW5kaW5nQ29tcG9uZW50KVxuICAgICAgICAgICAgY29uc3Qgb2JqZWN0ID0gZ2V0Q29tcG9uZW50KGVudGl0eSwgT2JqZWN0M0RDb21wb25lbnQpLnZhbHVlXG4gICAgICAgICAgICBjb25zdCBiYm94ID0gbmV3IEJveDMoKS5zZXRGcm9tT2JqZWN0KG9iamVjdC5jaGlsZHJlblswXSlcbiAgICAgICAgICAgIGFkZENvbXBvbmVudChlbnRpdHksIEF2YXRhckRpc3NvbHZlQ29tcG9uZW50LCB7XG4gICAgICAgICAgICAgIGVmZmVjdDogbmV3IERpc3NvbHZlRWZmZWN0KG9iamVjdCwgYmJveC5taW4ueSwgYmJveC5tYXgueSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBlbnRpdHkgb2YgZ3Jvd1F1ZXJ5LmV4aXQod29ybGQpKSB7XG4gICAgICAvLyBjb25zdCBwbGF0ZUNvbXBvbmVudCA9IGdldENvbXBvbmVudChlbnRpdHksIEF2YXRhckVmZmVjdENvbXBvbmVudClcbiAgICAgIC8vIGFkZENvbXBvbmVudChlbnRpdHksIFR3ZWVuQ29tcG9uZW50LCB7XG4gICAgICAvLyAgIHR3ZWVuOiBuZXcgVHdlZW48YW55PihwbGF0ZUNvbXBvbmVudClcbiAgICAgIC8vICAgICAudG8oXG4gICAgICAvLyAgICAgICB7XG4gICAgICAvLyAgICAgICAgIG9wYWNpdHlNdWx0aXBsaWVyOiAwXG4gICAgICAvLyAgICAgICB9LFxuICAgICAgLy8gICAgICAgMjAwMFxuICAgICAgLy8gICAgIClcbiAgICAgIC8vICAgICAuc3RhcnQoKVxuICAgICAgLy8gICAgIC5vbkNvbXBsZXRlKGFzeW5jICgpID0+IHtcbiAgICAgIC8vICAgICAgIHJlbW92ZUNvbXBvbmVudChlbnRpdHksIFR3ZWVuQ29tcG9uZW50KVxuICAgICAgLy8gICAgIH0pXG4gICAgICAvLyB9KVxuICAgIH1cblxuICAgIGZvciAoY29uc3QgZW50aXR5IG9mIGNvbW1vblF1ZXJ5KHdvcmxkKSkge1xuICAgICAgY29uc3Qgb2JqZWN0ID0gZ2V0Q29tcG9uZW50KGVudGl0eSwgT2JqZWN0M0RDb21wb25lbnQpLnZhbHVlXG4gICAgICBjb25zdCBvcGFjaXR5TXVsdGlwbGllciA9IGdldENvbXBvbmVudChlbnRpdHksIEF2YXRhckVmZmVjdENvbXBvbmVudCkub3BhY2l0eU11bHRpcGxpZXJcblxuICAgICAgbGV0IHBpbGxhcjogYW55ID0gbnVsbCFcbiAgICAgIGxldCBwbGF0ZTogYW55ID0gbnVsbCFcblxuICAgICAgY29uc3QgY2hpbGRyZW5zID0gb2JqZWN0LmNoaWxkcmVuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkcmVucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoY2hpbGRyZW5zW2ldLm5hbWUgPT09ICdwaWxsYXJfb2JqJykgcGlsbGFyID0gY2hpbGRyZW5zW2ldXG4gICAgICAgIGlmIChjaGlsZHJlbnNbaV0ubmFtZSA9PT0gJ3BsYXRlX29iaicpIHBsYXRlID0gY2hpbGRyZW5zW2ldXG4gICAgICB9XG5cbiAgICAgIGlmIChwaWxsYXIgIT09IG51bGwgJiYgcGxhdGUgIT09IG51bGwpIHtcbiAgICAgICAgcGxhdGVbJ21hdGVyaWFsJ10ub3BhY2l0eSA9IG9wYWNpdHlNdWx0aXBsaWVyICogKDAuNyArIDAuNSAqIE1hdGguc2luKChEYXRlLm5vdygpICUgNjI4MykgKiA1ZS0zKSlcbiAgICAgICAgaWYgKHBpbGxhciAhPT0gdW5kZWZpbmVkICYmIHBsYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbiA9IHBpbGxhci5jaGlsZHJlbi5sZW5ndGg7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICAgIHZhciByYXkgPSBwaWxsYXIuY2hpbGRyZW5baV1cbiAgICAgICAgICAgIHJheS5wb3NpdGlvbi55ICs9IDIgKiBkZWx0YVxuICAgICAgICAgICAgcmF5LnNjYWxlLnkgPSBsaWdodFNjYWxlKHJheS5wb3NpdGlvbi55LCByYXlbJ2dlb21ldHJ5J10uYm91bmRpbmdTcGhlcmUucmFkaXVzKVxuICAgICAgICAgICAgcmF5WydtYXRlcmlhbCddLm9wYWNpdHkgPSBsaWdodE9wYWNpdHkocmF5LnBvc2l0aW9uLnksIHJheVsnZ2VvbWV0cnknXS5ib3VuZGluZ1NwaGVyZS5yYWRpdXMpXG5cbiAgICAgICAgICAgIGlmIChyYXlbJ21hdGVyaWFsJ10ub3BhY2l0eSA8IDFlLTMpIHtcbiAgICAgICAgICAgICAgcmF5LnBvc2l0aW9uLnkgPSBwbGF0ZS5wb3NpdGlvbi55XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByYXlbJ21hdGVyaWFsJ10ub3BhY2l0eSAqPSBvcGFjaXR5TXVsdGlwbGllclxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAoY29uc3QgZW50aXR5IG9mIGRpc3NvbHZlUXVlcnkod29ybGQpKSB7XG4gICAgICAvLyBjb25zb2xlLmxvZyhcImRpc3NvbHZlXCIpXG4gICAgICBjb25zdCBvYmplY3RlZmZlY3QgPSBnZXRDb21wb25lbnQoZW50aXR5LCBBdmF0YXJEaXNzb2x2ZUNvbXBvbmVudCkuZWZmZWN0XG5cbiAgICAgIGlmIChvYmplY3RlZmZlY3QudXBkYXRlKGRlbHRhKSkge1xuICAgICAgICByZW1vdmVDb21wb25lbnQoZW50aXR5LCBBdmF0YXJEaXNzb2x2ZUNvbXBvbmVudClcbiAgICAgICAgY29uc3Qgb2JqZWN0ID0gZ2V0Q29tcG9uZW50KGVudGl0eSwgT2JqZWN0M0RDb21wb25lbnQpLnZhbHVlXG4gICAgICAgIGNvbnN0IHBsYXRlQ29tcG9uZW50ID0gZ2V0Q29tcG9uZW50KGVudGl0eSwgQXZhdGFyRWZmZWN0Q29tcG9uZW50KVxuXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKG9iamVjdCwgcGxhdGVDb21wb25lbnQub3JpZ2luTWF0ZXJpYWxzKVxuICAgICAgICBwbGF0ZUNvbXBvbmVudC5vcmlnaW5NYXRlcmlhbHMuZm9yRWFjaCgoeyBpZCwgbWF0ZXJpYWwgfSkgPT4ge1xuICAgICAgICAgIG9iamVjdC50cmF2ZXJzZSgob2JqKSA9PiB7XG4gICAgICAgICAgICBpZiAob2JqLnV1aWQgPT09IGlkKSB7XG4gICAgICAgICAgICAgIG9ialsnbWF0ZXJpYWwnXSA9IG1hdGVyaWFsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcblxuICAgICAgICBhZGRDb21wb25lbnQoZW50aXR5LCBUd2VlbkNvbXBvbmVudCwge1xuICAgICAgICAgIHR3ZWVuOiBuZXcgVHdlZW48YW55PihwbGF0ZUNvbXBvbmVudClcbiAgICAgICAgICAgIC50byhcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG9wYWNpdHlNdWx0aXBsaWVyOiAwXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIDIwMDBcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIC5zdGFydCgpXG4gICAgICAgICAgICAub25Db21wbGV0ZShhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgIHJlbW92ZUNvbXBvbmVudChlbnRpdHksIFR3ZWVuQ29tcG9uZW50KVxuXG4gICAgICAgICAgICAgIGNvbnN0IG9iamVjdCA9IGdldENvbXBvbmVudChlbnRpdHksIE9iamVjdDNEQ29tcG9uZW50KS52YWx1ZVxuICAgICAgICAgICAgICBsZXQgcGlsbGFyOiBhbnkgPSBudWxsIVxuICAgICAgICAgICAgICBsZXQgcGxhdGU6IGFueSA9IG51bGwhXG5cbiAgICAgICAgICAgICAgY29uc3QgY2hpbGRyZW5zID0gb2JqZWN0LmNoaWxkcmVuXG4gICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkcmVuc1tpXS5uYW1lID09PSAncGlsbGFyX29iaicpIHBpbGxhciA9IGNoaWxkcmVuc1tpXVxuICAgICAgICAgICAgICAgIGlmIChjaGlsZHJlbnNbaV0ubmFtZSA9PT0gJ3BsYXRlX29iaicpIHBsYXRlID0gY2hpbGRyZW5zW2ldXG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAocGlsbGFyICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcGlsbGFyLnRyYXZlcnNlKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkWydtYXRlcmlhbCddKSBjaGlsZFsnbWF0ZXJpYWwnXS5kaXNwb3NlKClcbiAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgcGlsbGFyLnBhcmVudC5yZW1vdmUocGlsbGFyKVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKHBsYXRlICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcGxhdGUudHJhdmVyc2UoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoY2hpbGRbJ21hdGVyaWFsJ10pIGNoaWxkWydtYXRlcmlhbCddLmRpc3Bvc2UoKVxuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICBwbGF0ZS5wYXJlbnQucmVtb3ZlKHBsYXRlKVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmVtb3ZlQ29tcG9uZW50KGVudGl0eSwgQXZhdGFyRWZmZWN0Q29tcG9uZW50KVxuXG4gICAgICAgICAgICAgIC8vIGlmIChpc0VudGl0eUxvY2FsQ2xpZW50KGVudGl0eSkpIHtcbiAgICAgICAgICAgICAgLy8gICBhZGRDb21wb25lbnQoZW50aXR5LCBMb2NhbElucHV0VGFnQ29tcG9uZW50LCB7fSlcbiAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gd29ybGRcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJ1bEJBT2EsR0FBMEIsRUFBbUQsMkJDa0JwRixFQUFhLENBQUMsRUFBRyxJQUNkLEtBQUssSUFBSSxFQUFHLEtBQUssSUFBSSxLQUFNLEVBQUksSUFHbEMsRUFBZSxDQUFDLEVBQUcsSUFDaEIsS0FBSyxJQUFJLEVBQUcsS0FBSyxJQUFJLEVBQUcsS0FBUyxHQUFLLHVCQUdHLEVBQStCLE1BRXpFLEdBQVksVUFBVSxDQUFFLElBQUssd0JBQzdCLEdBQVksVUFBVSxDQUFFLElBQUssd0JBRTdCLEdBQVksRUFBWSxDQUFDLEVBQXVCLEVBQW1CLElBQ25FLEVBQWMsRUFBWSxDQUFDLEVBQXVCLElBQ2xELEVBQWdCLEVBQVksQ0FBQyxFQUFpQixFQUFtQixVQUVoRSxJQUFNLE1BQ0wsQ0FBRSxTQUFVLFdBRVAsS0FBVSxHQUFVLE1BQU0sR0FBUSxNQUNyQyxHQUFTLEVBQWEsRUFBUSxHQUFtQixNQUNqRCxFQUFpQixFQUFhLEVBQVEsR0FFdEMsRUFBUyxHQUFJLEtBQ1osS0FBTyxlQUNQLElBQUksUUFFTCxHQUFNLEVBQWEsRUFBUSxHQUMzQixFQUFRLEVBQUksTUFDWixFQUFRLEVBQUksTUFFWixFQUFJLEdBQU0sRUFB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
